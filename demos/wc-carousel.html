<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>&lt;wc-carousel&gt; demo</title>
    <link rel="stylesheet" href="./demo-base.css" />
    <script type="module" src="../src/carousel.js"></script>
    <style>
      .carousel-grid {
        display: grid;
        gap: 1.75rem;
      }

      .carousel-card {
        display: grid;
        gap: 1rem;
      }

      .carousel-card p {
        margin: 0;
        color: rgba(15, 23, 42, 0.72);
      }

      .carousel-demo {
        --wc-carousel-width: 100%;
        --wc-carousel-control-background: rgba(15, 23, 42, 0.75);
        --wc-carousel-control-color: #fff;
        --wc-carousel-control-shadow: 0 10px 30px rgba(15, 23, 42, 0.35);
        --wc-carousel-gap: 0;
      }

      .carousel-slide {
        display: grid;
        place-items: center;
        font-size: 2rem;
        font-weight: 600;
        color: rgba(15, 23, 42, 0.85);
        background: linear-gradient(135deg, rgba(96, 165, 250, 0.12), rgba(165, 180, 252, 0.2));
        border-radius: 1rem;
        min-height: 220px;
      }

      .carousel-slide small {
        display: block;
        margin-top: 0.5rem;
        font-size: 0.85rem;
        font-weight: 500;
        color: rgba(15, 23, 42, 0.55);
      }

      wc-carousel-content[class~='-ml-1'] {
        margin-left: -0.25rem;
      }

      wc-carousel-content[class~='-ml-2'] {
        margin-left: -0.5rem;
      }

      wc-carousel-content[class~='md:-ml-4'] {
        margin-left: -1rem;
      }

      wc-carousel-item[class~='pl-1'] {
        padding-left: 0.25rem;
      }

      wc-carousel-item[class~='pl-2'] {
        padding-left: 0.5rem;
      }

      wc-carousel-item[class~='md:pl-4'] {
        padding-left: 1rem;
      }

      wc-carousel-item[class~='basis-1/3'] {
        flex-basis: 33.333%;
      }

      @media (min-width: 768px) {
        wc-carousel-item[class~='md:basis-1/2'] {
          flex-basis: 50%;
        }
      }

      @media (min-width: 1024px) {
        wc-carousel-item[class~='lg:basis-1/3'] {
          flex-basis: 33.333%;
        }
      }

      .carousel-indicator {
        margin-top: 0.75rem;
        font-size: 0.9rem;
        font-weight: 500;
        color: rgba(15, 23, 42, 0.6);
        text-align: center;
      }

      .vertical-demo {
        max-width: 340px;
      }

      .vertical-demo .carousel-slide {
        min-height: 140px;
      }

      .vertical-demo wc-carousel-content {
        height: 320px;
      }

      [data-code-example] wc-carousel {
        display: block;
      }
    </style>
  </head>
  <body>
    <main>
      <section data-docs="wc-carousel"></section>
      <section class="carousel-grid">
        <div class="example-card carousel-card">
          <h3>Looping cards</h3>
          <p>A horizontal carousel with looping navigation and swipe gestures.</p>
          <div data-code-example>
            <wc-carousel class="carousel-demo" loop>
              <wc-carousel-content>
                <wc-carousel-item><div class="carousel-slide">1</div></wc-carousel-item>
                <wc-carousel-item><div class="carousel-slide">2</div></wc-carousel-item>
                <wc-carousel-item><div class="carousel-slide">3</div></wc-carousel-item>
                <wc-carousel-item><div class="carousel-slide">4</div></wc-carousel-item>
                <wc-carousel-item><div class="carousel-slide">5</div></wc-carousel-item>
              </wc-carousel-content>
              <wc-carousel-previous></wc-carousel-previous>
              <wc-carousel-next></wc-carousel-next>
            </wc-carousel>
          </div>
        </div>

        <div class="example-card carousel-card">
          <h3>Responsive widths & spacing</h3>
          <p>Utility classes like <code>md:basis-1/2</code> and <code>pl-2</code> carry straight over.</p>
          <div data-code-example>
            <wc-carousel class="carousel-demo" style="--wc-carousel-gap: 0;">
              <wc-carousel-content class="-ml-2 md:-ml-4">
                <wc-carousel-item class="pl-2 md:pl-4 md:basis-1/2 lg:basis-1/3">
                  <div class="carousel-slide">
                    1
                    <small>md:basis-1/2</small>
                  </div>
                </wc-carousel-item>
                <wc-carousel-item class="pl-2 md:pl-4 md:basis-1/2 lg:basis-1/3">
                  <div class="carousel-slide">
                    2
                    <small>lg:basis-1/3</small>
                  </div>
                </wc-carousel-item>
                <wc-carousel-item class="pl-2 md:pl-4 md:basis-1/2 lg:basis-1/3">
                  <div class="carousel-slide">
                    3
                    <small>Auto wraps</small>
                  </div>
                </wc-carousel-item>
                <wc-carousel-item class="pl-2 md:pl-4 md:basis-1/2 lg:basis-1/3">
                  <div class="carousel-slide">
                    4
                    <small>Snap aligned</small>
                  </div>
                </wc-carousel-item>
              </wc-carousel-content>
              <wc-carousel-previous></wc-carousel-previous>
              <wc-carousel-next></wc-carousel-next>
            </wc-carousel>
          </div>
        </div>

        <div class="example-card carousel-card">
          <h3>Vertical orientation</h3>
          <p>Switch to <code>orientation="vertical"</code> for stacked content.</p>
          <div class="vertical-demo" data-code-example>
            <wc-carousel class="carousel-demo" orientation="vertical" align="start">
              <wc-carousel-content class="-ml-1">
                <wc-carousel-item class="pl-1">
                  <div class="carousel-slide">
                    1
                    <small>Stack</small>
                  </div>
                </wc-carousel-item>
                <wc-carousel-item class="pl-1">
                  <div class="carousel-slide">
                    2
                    <small>Scroll</small>
                  </div>
                </wc-carousel-item>
                <wc-carousel-item class="pl-1">
                  <div class="carousel-slide">
                    3
                    <small>Snap</small>
                  </div>
                </wc-carousel-item>
                <wc-carousel-item class="pl-1">
                  <div class="carousel-slide">
                    4
                    <small>Repeat</small>
                  </div>
                </wc-carousel-item>
              </wc-carousel-content>
              <wc-carousel-previous></wc-carousel-previous>
              <wc-carousel-next></wc-carousel-next>
            </wc-carousel>
          </div>
        </div>

        <div class="example-card carousel-card">
          <h3>API & autoplay plugin</h3>
          <p>Use <code>setApi</code> to track progress and register Embla-style plugins.</p>
          <div data-code-example>
            <wc-carousel id="api-carousel" class="carousel-demo" loop>
              <wc-carousel-content>
                <wc-carousel-item><div class="carousel-slide">A</div></wc-carousel-item>
                <wc-carousel-item><div class="carousel-slide">B</div></wc-carousel-item>
                <wc-carousel-item><div class="carousel-slide">C</div></wc-carousel-item>
                <wc-carousel-item><div class="carousel-slide">D</div></wc-carousel-item>
                <wc-carousel-item><div class="carousel-slide">E</div></wc-carousel-item>
              </wc-carousel-content>
              <wc-carousel-previous></wc-carousel-previous>
              <wc-carousel-next></wc-carousel-next>
            </wc-carousel>
            <div class="carousel-indicator" data-carousel-indicator>Slide 1 of 5</div>
          </div>
        </div>
      </section>
    </main>

    <script type="module">
      const indicator = document.querySelector('[data-carousel-indicator]');
      const apiCarousel = document.querySelector('#api-carousel');

      const createAutoplay = ({ delay = 3200, stopOnInteraction = true } = {}) => {
        let timer;
        let api;
        const start = () => {
          clearInterval(timer);
          if (!api) return;
          timer = window.setInterval(() => api.scrollNext(), delay);
        };
        const stop = () => {
          clearInterval(timer);
        };
        const readyHandler = () => start();
        const selectHandler = () => start();
        const pointerDownHandler = () => stopOnInteraction && stop();
        const pointerUpHandler = () => stopOnInteraction && start();

        return {
          init(carouselApi) {
            api = carouselApi;
            api.on('ready', readyHandler);
            api.on('select', selectHandler);
            api.on('pointerDown', pointerDownHandler);
            api.on('pointerUp', pointerUpHandler);
            start();
          },
          destroy() {
            stop();
            if (!api) return;
            api.off('ready', readyHandler);
            api.off('select', selectHandler);
            api.off('pointerDown', pointerDownHandler);
            api.off('pointerUp', pointerUpHandler);
            api = undefined;
          },
          stop,
          reset: start
        };
      };

      const autoplay = createAutoplay({ delay: 2600, stopOnInteraction: true });
      apiCarousel.plugins = [autoplay];
      apiCarousel.addEventListener('mouseenter', () => autoplay.stop());
      apiCarousel.addEventListener('mouseleave', () => autoplay.reset());

      apiCarousel.setApi = (api) => {
        const updateIndicator = () => {
          const index = api.selectedScrollSnap();
          indicator.textContent = `Slide ${index + 1} of ${api.scrollSnapList().length}`;
        };

        api.on('ready', updateIndicator);
        api.on('select', updateIndicator);
        updateIndicator();
      };
    </script>
    
    <script type="module">
      import { renderComponentDocs } from './component-docs.js';
      renderComponentDocs('wc-carousel');
    </script>
    <script type="module" src="./demo-code-blocks.js"></script>
  </body>
</html>
