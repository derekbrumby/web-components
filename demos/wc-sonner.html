<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>&lt;wc-sonner&gt; demo</title>
    <link rel="stylesheet" href="./demo-base.css" />
    <script type="module" src="../src/sonner.js"></script>
    <style>
      .sonner-card {
        display: grid;
        gap: 1.5rem;
      }

      .sonner-actions {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
      }

      .sonner-actions button {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 0.45rem 0.95rem;
        border-radius: 999px;
        border: 1px solid rgba(148, 163, 184, 0.3);
        background: rgba(15, 23, 42, 0.04);
        color: rgb(15, 23, 42);
        font-weight: 600;
        cursor: pointer;
        transition: transform 120ms ease, box-shadow 120ms ease;
      }

      .sonner-actions button:hover {
        transform: translateY(-1px);
        box-shadow: 0 10px 18px -12px rgba(15, 23, 42, 0.25);
      }

      .sonner-actions button:focus-visible {
        outline: 2px solid rgba(59, 130, 246, 0.55);
        outline-offset: 3px;
      }

      .sonner-log {
        inline-size: 100%;
        min-block-size: 6rem;
        font-family: "JetBrains Mono", "Fira Code", Consolas, Monaco, monospace;
      }
    </style>
  </head>
  <body>
    <main>
      <section data-docs="wc-sonner"></section>
      <section>
        <header>
          <h2>Sonner-style toast launcher</h2>
          <p>
            Trigger notification variants that mirror the Sonner React API. Each button uses the bound `toast`
            helpers on `<wc-sonner>` and logs lifecycle events underneath.
          </p>
        </header>

        <div class="example-card sonner-card" data-code-example>
          <div class="sonner-actions">
            <button type="button" data-kind="default">Default</button>
            <button type="button" data-kind="success">Success</button>
            <button type="button" data-kind="info">Info</button>
            <button type="button" data-kind="warning">Warning</button>
            <button type="button" data-kind="error">Error</button>
            <button type="button" data-kind="promise">Promise</button>
          </div>

          <wc-sonner id="demo-sonner" position="bottom-right" close-on-click></wc-sonner>

          <pre class="log sonner-log" id="sonner-log">Press a button to trigger a toast.</pre>
        </div>
      </section>
    </main>

    <script type="module">
      const toaster = document.getElementById('demo-sonner');
      const log = document.getElementById('sonner-log');
      const buttons = document.querySelectorAll('[data-kind]');

      const setLog = (message) => {
        if (log) {
          log.textContent = message;
        }
      };

      const dateDescription = () =>
        new Date().toLocaleString('en-US', {
          dateStyle: 'full',
          timeStyle: 'short',
        });

      buttons.forEach((button) => {
        button.addEventListener('click', async () => {
          if (!toaster) {
            return;
          }

          const kind = button.getAttribute('data-kind');

          if (kind === 'promise') {
            setLog('Loading an async task...');
            try {
              await toaster.toast.promise(
                () =>
                  new Promise((resolve) => {
                    window.setTimeout(() => resolve({ name: 'Event' }), 1800);
                  }),
                {
                  loading: 'Saving event…',
                  success: (result) => `${result.name} has been created`,
                  error: () => 'Event failed to save',
                }
              );
            } catch (error) {
              console.error(error);
            }
            return;
          }

          const description = `Scheduled for ${dateDescription()}`;

          switch (kind) {
            case 'success':
              toaster.toast.success('Event has been created', { description });
              break;
            case 'info':
              toaster.toast.info('Arrive 10 minutes before the event', { description });
              break;
            case 'warning':
              toaster.toast.warning('Start time must be after 8:00 AM', { description });
              break;
            case 'error':
              toaster.toast.error('Event could not be created', {
                description,
                action: {
                  label: 'Retry',
                  onClick: () => setLog('Retry clicked – attempt the action again.'),
                },
              });
              break;
            default:
              toaster.toast('Event has been created', {
                description,
                action: {
                  label: 'Undo',
                  onClick: () => setLog('Undo clicked – the event was reverted.'),
                },
              });
              break;
          }
        });
      });

      toaster?.addEventListener('wc-sonner-open', (event) => {
        const id = event.detail?.id ?? 'unknown';
        setLog(`Toast ${id} opened.`);
      });

      toaster?.addEventListener('wc-sonner-dismiss', (event) => {
        const id = event.detail?.id ?? 'unknown';
        const reason = event.detail?.reason ?? 'manual';
        setLog(`Toast ${id} dismissed via ${reason}.`);
      });
    </script>

    <script type="module">
      import { renderComponentDocs } from './component-docs.js';
      renderComponentDocs('wc-sonner');
    </script>
    <script type="module" src="./demo-code-blocks.js"></script>
  </body>
</html>

