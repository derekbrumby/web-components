<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>&lt;wc-drawer&gt; demo</title>
    <link rel="stylesheet" href="./demo-base.css" />
    <script type="module" src="../src/drawer.js"></script>
    <script type="module" src="../src/progress.js"></script>
    <style>
      .drawer-card {
        display: grid;
        gap: 1rem;
      }

      .drawer-card p {
        margin: 0;
      }

      .drawer-goal {
        display: grid;
        gap: 1.25rem;
      }

      .drawer-goal-controls {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 1.5rem;
      }

      .drawer-step {
        inline-size: 2.5rem;
        block-size: 2.5rem;
        border-radius: 999px;
        border: none;
        background: rgba(15, 23, 42, 0.08);
        color: inherit;
        font-size: 1.25rem;
        font-weight: 600;
        cursor: pointer;
        transition: background-color 160ms ease, transform 160ms ease;
      }

      .drawer-step:hover:not(:disabled) {
        background: rgba(79, 70, 229, 0.12);
      }

      .drawer-step:active:not(:disabled) {
        transform: scale(0.95);
      }

      .drawer-step:disabled {
        opacity: 0.4;
        cursor: not-allowed;
      }

      .drawer-goal-value {
        display: grid;
        gap: 0.25rem;
        text-align: center;
      }

      .drawer-goal-value output {
        font-size: clamp(2.25rem, 8vw, 3.5rem);
        font-weight: 700;
        letter-spacing: -0.03em;
      }

      .drawer-goal-meter {
        display: grid;
        gap: 0.65rem;
      }

      .drawer-footer {
        display: flex;
        justify-content: flex-end;
        gap: 0.75rem;
      }

      .drawer-status {
        font-size: 0.95rem;
        color: rgba(15, 23, 42, 0.8);
      }

      .drawer-form {
        display: grid;
        gap: 1rem;
      }

      .drawer-form fieldset {
        border: none;
        margin: 0;
        padding: 0;
        display: grid;
        gap: 0.75rem;
      }

      .drawer-notification-option {
        display: flex;
        align-items: flex-start;
        gap: 0.75rem;
        padding: 0.75rem;
        border-radius: 0.75rem;
        border: 1px solid rgba(15, 23, 42, 0.12);
        background: rgba(248, 250, 252, 0.65);
      }

      .drawer-notification-option input[type='checkbox'] {
        margin-top: 0.25rem;
      }

      .drawer-notification-content {
        display: grid;
        gap: 0.25rem;
      }

      .drawer-notification-content strong {
        font-size: 1rem;
      }

      .drawer-notification-content span {
        font-size: 0.9rem;
        color: rgba(15, 23, 42, 0.7);
      }

      .drawer-save-toast {
        margin: 0;
        font-family: var(--demo-mono-font);
        font-size: 0.9rem;
        color: rgba(15, 23, 42, 0.85);
      }
    </style>
  </head>
  <body>
    <main>
      <section>
        <div class="example-grid two-column">
          <div class="example-card drawer-card">
            <h3>Activity goal planner</h3>
            <p>
              Adjust your move goal between 200 and 400 calories. The drawer keeps focus trapped and updates the
              progress indicator as you make changes.
            </p>
            <wc-drawer
              id="drawer-activity"
              style="
                --drawer-width: min(420px, 100vw);
                --drawer-padding: 1.75rem;
                --drawer-background: rgba(248, 250, 252, 0.98);
                --drawer-overlay-background: rgba(15, 23, 42, 0.35);
                --drawer-shadow: 0 36px 70px -40px rgba(15, 23, 42, 0.6);
                --drawer-section-gap: 1.35rem;
              "
            >
              <button slot="trigger">Open drawer</button>
              <span slot="title">Move goal</span>
              <span slot="description">Set your daily activity goal.</span>
              <div class="drawer-goal" aria-live="polite">
                <div class="drawer-goal-controls">
                  <button type="button" class="drawer-step" data-drawer-step="-10" aria-label="Decrease goal">
                    âˆ’
                  </button>
                  <div class="drawer-goal-value">
                    <output id="drawer-activity-goal" for="drawer-activity">350</output>
                    <span>calories/day</span>
                  </div>
                  <button type="button" class="drawer-step" data-drawer-step="10" aria-label="Increase goal">
                    +
                  </button>
                </div>
                <div class="drawer-goal-meter">
                  <wc-progress id="drawer-activity-progress" value="150" max="200" label="Daily activity goal"></wc-progress>
                  <p class="drawer-save-toast" id="drawer-activity-summary">Goal set to 350 calories per day.</p>
                </div>
              </div>
              <div slot="footer" class="drawer-footer">
                <button type="button" class="ghost-button" data-drawer-close>Cancel</button>
                <button type="button" id="drawer-activity-save">Save goal</button>
              </div>
            </wc-drawer>
            <p class="drawer-status" id="drawer-activity-status">Current goal: 350 calories per day.</p>
          </div>

          <div class="example-card drawer-card">
            <h3>Team notification presets</h3>
            <p>
              This drawer slides from the right edge and demonstrates how you can build richer forms with sticky actions
              and instant summaries.
            </p>
            <wc-drawer
              id="drawer-team"
              placement="right"
              style="
                --drawer-width: min(360px, 92vw);
                --drawer-height: 100vh;
                --drawer-radius: 1.25rem 0 0 1.25rem;
                --drawer-padding: 1.75rem;
                --drawer-background: rgba(255, 255, 255, 0.97);
                --drawer-shadow: 0 24px 48px -24px rgba(15, 23, 42, 0.45);
              "
            >
              <button slot="trigger" class="ghost-button">Manage notifications</button>
              <span slot="title">Team notifications</span>
              <span slot="description">Choose which events should ping you in real time.</span>
              <form class="drawer-form" id="drawer-team-form">
                <fieldset>
                  <legend class="sr-only">Notification channels</legend>
                  <label class="drawer-notification-option">
                    <input type="checkbox" name="notifications" value="mentions" data-label="Mentions" checked />
                    <span class="drawer-notification-content">
                      <strong>Mentions</strong>
                      <span>Direct @mentions and replies across channels.</span>
                    </span>
                  </label>
                  <label class="drawer-notification-option">
                    <input type="checkbox" name="notifications" value="launches" data-label="Launch updates" checked />
                    <span class="drawer-notification-content">
                      <strong>Launch updates</strong>
                      <span>Critical shipping milestones and release blockers.</span>
                    </span>
                  </label>
                  <label class="drawer-notification-option">
                    <input type="checkbox" name="notifications" value="summaries" data-label="Weekly summary" />
                    <span class="drawer-notification-content">
                      <strong>Weekly summary</strong>
                      <span>Friday digest covering highlights and outstanding work.</span>
                    </span>
                  </label>
                </fieldset>
              </form>
              <div slot="footer" class="drawer-footer">
                <button type="button" class="ghost-button" data-drawer-close>Cancel</button>
                <button type="button" id="drawer-team-save">Save preferences</button>
              </div>
            </wc-drawer>
            <p class="drawer-status" id="drawer-team-status">Notifications: Mentions, Launch updates.</p>
          </div>
        </div>
      </section>
    </main>

    <script>
      const drawerActivity = document.getElementById('drawer-activity');
      const activityGoalOutput = document.getElementById('drawer-activity-goal');
      const activityProgress = document.getElementById('drawer-activity-progress');
      const activitySummary = document.getElementById('drawer-activity-summary');
      const activityStatus = document.getElementById('drawer-activity-status');
      const activitySave = document.getElementById('drawer-activity-save');
      const activityDecrease = drawerActivity?.querySelector('[data-drawer-step="-10"]');
      const activityIncrease = drawerActivity?.querySelector('[data-drawer-step="10"]');

      const MIN_GOAL = 200;
      const MAX_GOAL = 400;
      let currentGoal = 350;

      const clampGoal = (value) => Math.min(MAX_GOAL, Math.max(MIN_GOAL, value));

      const updateGoalUI = () => {
        if (!activityGoalOutput || !activityProgress || !activitySummary) return;
        activityGoalOutput.textContent = String(currentGoal);
        const progressValue = currentGoal - MIN_GOAL;
        const progressMax = MAX_GOAL - MIN_GOAL;
        activityProgress.max = progressMax;
        activityProgress.value = progressValue;
        activityProgress.valueText = `${currentGoal} calories per day`;
        activitySummary.textContent = `Goal set to ${currentGoal} calories per day.`;
        if (activityDecrease instanceof HTMLButtonElement) {
          activityDecrease.disabled = currentGoal <= MIN_GOAL;
        }
        if (activityIncrease instanceof HTMLButtonElement) {
          activityIncrease.disabled = currentGoal >= MAX_GOAL;
        }
      };

      updateGoalUI();

      document.addEventListener('click', (event) => {
        const stepButton = event.target instanceof HTMLElement ? event.target.closest('[data-drawer-step]') : null;
        if (!stepButton || !drawerActivity || !stepButton.closest('#drawer-activity')) {
          return;
        }
        event.preventDefault();
        const step = Number(stepButton.getAttribute('data-drawer-step')) || 0;
        currentGoal = clampGoal(currentGoal + step);
        updateGoalUI();
      });

      drawerActivity?.addEventListener('drawer-open', () => {
        if (activitySummary) {
          activitySummary.textContent = `Goal set to ${currentGoal} calories per day.`;
        }
      });

      drawerActivity?.addEventListener('drawer-close', () => {
        if (activityStatus) {
          activityStatus.textContent = `Current goal: ${currentGoal} calories per day.`;
        }
      });

      activitySave?.addEventListener('click', () => {
        if (activityStatus) {
          activityStatus.textContent = `Goal saved at ${currentGoal} calories per day.`;
        }
        drawerActivity?.hide?.();
      });

      const drawerTeam = document.getElementById('drawer-team');
      const teamForm = document.getElementById('drawer-team-form');
      const teamStatus = document.getElementById('drawer-team-status');
      const teamSave = document.getElementById('drawer-team-save');

      const formatTeamSummary = () => {
        if (!(teamForm instanceof HTMLFormElement)) return 'Notifications disabled.';
        const checkboxes = Array.from(teamForm.querySelectorAll('input[type="checkbox"]'));
        const active = checkboxes
          .filter((input) => input instanceof HTMLInputElement && input.checked)
          .map((input) => input.getAttribute('data-label') || input.value)
          .filter((label) => Boolean(label));
        if (active.length === 0) {
          return 'Notifications disabled.';
        }
        if (active.length === 1) {
          return `Notifications: ${active[0]}.`;
        }
        const last = active.pop();
        return `Notifications: ${active.join(', ')} and ${last}.`;
      };

      teamSave?.addEventListener('click', () => {
        if (teamStatus) {
          teamStatus.textContent = formatTeamSummary();
        }
        drawerTeam?.hide?.();
      });

      drawerTeam?.addEventListener('drawer-close', () => {
        if (teamStatus) {
          teamStatus.textContent = formatTeamSummary();
        }
      });
    </script>
  </body>
</html>
